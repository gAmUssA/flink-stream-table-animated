<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flink Table-Stream Duality Interactive Demo</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Flink SQL &amp; Table API</h1>
            <p>Interactive Tutorial: Dynamic Tables and Changelog Streams</p>
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <span class="theme-icon">üåô</span>
            </button>
        </div>

        <div class="navigation">
            <button class="nav-btn active" onclick="showSection(0)"><span class="nav-btn-icon">‚óà</span> Core Concept</button>
            <button class="nav-btn" onclick="showSection(1)"><span class="nav-btn-icon">‚Üì</span> Stream ‚Üí Table</button>
            <button class="nav-btn" onclick="showSection(2)"><span class="nav-btn-icon">‚Üë</span> Table ‚Üí Stream</button>
            <button class="nav-btn" onclick="showSection(3)"><span class="nav-btn-icon">¬±</span> Changelog Types</button>
            <button class="nav-btn" onclick="showSection(4)"><span class="nav-btn-icon">‚ñ∂</span> Live SQL</button>
            <button class="nav-btn" onclick="showSection(5)"><span class="nav-btn-icon">{ }</span> Code Examples</button>
        </div>

        <div class="content">
            <!-- Section 0: Core Concept -->
            <div class="demo-section active" id="section-0">
                <h2 class="section-title">Dynamic Tables &amp; Changelog Streams</h2>
                <div class="description">
                    In Flink SQL, a Dynamic Table is the core abstraction. It represents data that changes over time,
                    and can be queried continuously using standard SQL.
                </div>

                <div class="visualization">
                    <!-- Duality Diagram as IDE Window -->
                    <div class="ide-window">
                        <div class="ide-titlebar">
                            <div class="ide-titlebar-buttons">
                                <span class="ide-titlebar-btn close"></span>
                                <span class="ide-titlebar-btn minimize"></span>
                                <span class="ide-titlebar-btn maximize"></span>
                            </div>
                            <span class="ide-titlebar-title">concept.md ‚Äî Table-Stream Duality</span>
                        </div>
                        <div style="padding: 30px; text-align: center;">
                            <div style="display: inline-block; padding: 25px 35px; background: var(--feature-stream-bg); border-radius: 10px; margin: 15px; border: 1px solid var(--border-primary);">
                                <h3 style="color: var(--feature-stream-heading); margin-bottom: 12px; font-size: 1.1em;">CHANGELOG STREAM</h3>
                                <p style="color: var(--ui-neutral-text); font-size: 0.9em;">Sequence of changes</p>
                                <code style="display: block; margin-top: 10px; font-size: 0.8em; color: var(--code-comment);">+I, -U, +U, -D</code>
                            </div>
                            
                            <div style="display: inline-block; font-size: 2.5em; color: var(--ui-duality-arrow); margin: 0 25px; vertical-align: middle;">‚áÑ</div>
                            
                            <div style="display: inline-block; padding: 25px 35px; background: var(--feature-table-bg); border-radius: 10px; margin: 15px; border: 1px solid var(--border-primary);">
                                <h3 style="color: var(--feature-table-heading); margin-bottom: 12px; font-size: 1.1em;">DYNAMIC TABLE</h3>
                                <p style="color: var(--ui-neutral-text); font-size: 0.9em;">Queryable snapshot</p>
                                <code style="display: block; margin-top: 10px; font-size: 0.8em; color: var(--code-comment);">SELECT * FROM ...</code>
                            </div>
                        </div>
                    </div>

                    <!-- SQL Example -->
                    <div class="ide-window" style="margin-top: 25px;">
                        <div class="ide-titlebar">
                            <div class="ide-titlebar-buttons">
                                <span class="ide-titlebar-btn close"></span>
                                <span class="ide-titlebar-btn minimize"></span>
                                <span class="ide-titlebar-btn maximize"></span>
                            </div>
                            <span class="ide-titlebar-title">example.sql</span>
                        </div>
                        <div class="ide-editor">
                            <div class="ide-line-numbers">
                                <div class="ide-line-number">1</div>
                                <div class="ide-line-number">2</div>
                                <div class="ide-line-number highlighted">3</div>
                                <div class="ide-line-number highlighted">4</div>
                                <div class="ide-line-number highlighted">5</div>
                            </div>
                            <div class="ide-code-content">
                                <div class="ide-code-line"><span class="comment">-- Query a dynamic table with standard SQL</span></div>
                                <div class="ide-code-line"><span class="comment">-- Results update continuously as data arrives</span></div>
                                <div class="ide-code-line highlighted"><span class="keyword">SELECT</span> user_id, <span class="function">SUM</span>(amount) <span class="keyword">AS</span> total</div>
                                <div class="ide-code-line highlighted"><span class="keyword">FROM</span> orders</div>
                                <div class="ide-code-line highlighted"><span class="keyword">GROUP BY</span> user_id;</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-box" style="margin-top: 25px;">
                        <strong>Key Insight:</strong> Every SQL query on a dynamic table produces a changelog stream.
                        Aggregations emit updates (-U, +U), while simple projections emit inserts (+I) only.
                    </div>

                    <div style="margin-top: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px;">
                        <div class="ide-window" style="margin: 0;">
                            <div class="ide-titlebar" style="padding: 8px 12px;">
                                <span class="ide-titlebar-title" style="text-align: left; font-size: 0.75em;">SQL Queries</span>
                            </div>
                            <div style="padding: 15px;">
                                <p style="color: var(--ui-neutral-text); font-size: 0.9em;">Write standard SQL on streaming data</p>
                            </div>
                        </div>
                        <div class="ide-window" style="margin: 0;">
                            <div class="ide-titlebar" style="padding: 8px 12px;">
                                <span class="ide-titlebar-title" style="text-align: left; font-size: 0.75em;">Table API</span>
                            </div>
                            <div style="padding: 15px;">
                                <p style="color: var(--ui-neutral-text); font-size: 0.9em;">Fluent Java/Scala/Python API</p>
                            </div>
                        </div>
                        <div class="ide-window" style="margin: 0;">
                            <div class="ide-titlebar" style="padding: 8px 12px;">
                                <span class="ide-titlebar-title" style="text-align: left; font-size: 0.75em;">Unified Batch & Stream</span>
                            </div>
                            <div style="padding: 15px;">
                                <p style="color: var(--ui-neutral-text); font-size: 0.9em;">Same queries for both modes</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 1: Stream to Table -->
            <div class="demo-section" id="section-1">
                <h2 class="section-title">Creating Dynamic Tables</h2>
                <div class="description">
                    Define a table from a streaming source using SQL DDL. Each incoming event becomes a row in the dynamic table.
                </div>

                <div class="controls">
                    <button class="btn btn-primary" onclick="streamToTable()">‚ñ∂ Run</button>
                    <button class="btn btn-secondary" onclick="resetStreamToTable()">Reset</button>
                </div>

                <div class="visualization">
                    <!-- SQL DDL Example -->
                    <div class="ide-window">
                        <div class="ide-titlebar">
                            <div class="ide-titlebar-buttons">
                                <span class="ide-titlebar-btn close"></span>
                                <span class="ide-titlebar-btn minimize"></span>
                                <span class="ide-titlebar-btn maximize"></span>
                            </div>
                            <span class="ide-titlebar-title">create_table.sql</span>
                        </div>
                        <div class="ide-editor">
                            <div class="ide-line-numbers">
                                <div class="ide-line-number">1</div>
                                <div class="ide-line-number">2</div>
                                <div class="ide-line-number">3</div>
                                <div class="ide-line-number">4</div>
                                <div class="ide-line-number">5</div>
                                <div class="ide-line-number">6</div>
                                <div class="ide-line-number">7</div>
                                <div class="ide-line-number">8</div>
                            </div>
                            <div class="ide-code-content">
                                <div class="ide-code-line"><span class="keyword">CREATE TABLE</span> orders (</div>
                                <div class="ide-code-line">    user_id    <span class="function">STRING</span>,</div>
                                <div class="ide-code-line">    product    <span class="function">STRING</span>,</div>
                                <div class="ide-code-line">    amount     <span class="function">DECIMAL</span>(10, 2),</div>
                                <div class="ide-code-line">    order_time <span class="function">TIMESTAMP</span>(3)</div>
                                <div class="ide-code-line">) <span class="keyword">WITH</span> (</div>
                                <div class="ide-code-line">    <span class="string">'connector'</span> = <span class="string">'kafka'</span></div>
                                <div class="ide-code-line">);</div>
                            </div>
                        </div>
                    </div>

                    <div class="conversion-arrow">‚Üì</div>

                    <!-- Kafka Topic visualization -->
                    <div class="ide-window">
                        <div class="ide-titlebar">
                            <div class="ide-titlebar-buttons">
                                <span class="ide-titlebar-btn close"></span>
                                <span class="ide-titlebar-btn minimize"></span>
                                <span class="ide-titlebar-btn maximize"></span>
                            </div>
                            <span class="ide-titlebar-title">kafka-console-consumer --topic orders</span>
                        </div>
                        <div class="kafka-messages" id="stream-events">
                            <div class="kafka-empty">Waiting for messages...</div>
                        </div>
                    </div>

                    <div class="conversion-arrow">‚Üì</div>

                    <!-- Dynamic Table Result -->
                    <div class="ide-window">
                        <div class="ide-titlebar">
                            <div class="ide-titlebar-buttons">
                                <span class="ide-titlebar-btn close"></span>
                                <span class="ide-titlebar-btn minimize"></span>
                                <span class="ide-titlebar-btn maximize"></span>
                            </div>
                            <span class="ide-titlebar-title">Dynamic Table: orders</span>
                        </div>
                        <div class="table-container" style="border: none; border-radius: 0;">
                            <table id="append-table">
                                <thead>
                                    <tr>
                                        <th>user_id</th>
                                        <th>product</th>
                                        <th>amount</th>
                                        <th>order_time</th>
                                    </tr>
                                </thead>
                                <tbody id="append-table-body">
                                    <tr><td colspan="4" style="text-align: center; color: var(--ui-muted-text);">Run to see data flow</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="info-box" style="margin-top: 20px;">
                        <strong>Append-Only:</strong> Each Kafka message becomes a new row (+I insert). 
                        The dynamic table grows continuously. Query it with <code>SELECT * FROM orders</code>.
                    </div>
                </div>
            </div>

            <!-- Section 2: Table to Stream -->
            <div class="demo-section" id="section-2">
                <h2 class="section-title">Aggregations &amp; Changelog Output</h2>
                <div class="description">
                    SQL aggregations produce updating results. Each update emits changelog events that downstream systems can consume.
                </div>

                <div class="controls">
                    <button class="btn btn-primary" onclick="tableToStream()">‚ñ∂ Run</button>
                    <button class="btn btn-secondary" onclick="resetTableToStream()">Reset</button>
                </div>

                <div class="visualization">
                    <!-- SQL Query -->
                    <div class="ide-window">
                        <div class="ide-titlebar">
                            <div class="ide-titlebar-buttons">
                                <span class="ide-titlebar-btn close"></span>
                                <span class="ide-titlebar-btn minimize"></span>
                                <span class="ide-titlebar-btn maximize"></span>
                            </div>
                            <span class="ide-titlebar-title">aggregation.sql</span>
                        </div>
                        <div class="ide-editor">
                            <div class="ide-line-numbers">
                                <div class="ide-line-number">1</div>
                                <div class="ide-line-number highlighted">2</div>
                                <div class="ide-line-number highlighted">3</div>
                                <div class="ide-line-number highlighted">4</div>
                            </div>
                            <div class="ide-code-content">
                                <div class="ide-code-line"><span class="comment">-- Aggregation produces changelog with updates</span></div>
                                <div class="ide-code-line highlighted"><span class="keyword">SELECT</span> user_id, <span class="function">SUM</span>(amount) <span class="keyword">AS</span> total, <span class="function">COUNT</span>(*) <span class="keyword">AS</span> cnt</div>
                                <div class="ide-code-line highlighted"><span class="keyword">FROM</span> orders</div>
                                <div class="ide-code-line highlighted"><span class="keyword">GROUP BY</span> user_id;</div>
                            </div>
                        </div>
                    </div>

                    <div class="split-view" style="margin-top: 20px;">
                        <div>
                            <div class="ide-window" style="margin: 0;">
                                <div class="ide-titlebar">
                                    <div class="ide-titlebar-buttons">
                                        <span class="ide-titlebar-btn close"></span>
                                        <span class="ide-titlebar-btn minimize"></span>
                                        <span class="ide-titlebar-btn maximize"></span>
                                    </div>
                                    <span class="ide-titlebar-title">Result Table (Updating)</span>
                                </div>
                                <div class="table-container" style="border: none; border-radius: 0;">
                                    <table id="dynamic-table">
                                        <thead>
                                            <tr>
                                                <th>user_id</th>
                                                <th>total</th>
                                                <th>cnt</th>
                                            </tr>
                                        </thead>
                                        <tbody id="dynamic-table-body">
                                            <tr><td colspan="3" style="text-align: center; color: var(--ui-muted-text);">Run query</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div>
                            <div class="ide-window" style="margin: 0;">
                                <div class="ide-titlebar">
                                    <div class="ide-titlebar-buttons">
                                        <span class="ide-titlebar-btn close"></span>
                                        <span class="ide-titlebar-btn minimize"></span>
                                        <span class="ide-titlebar-btn maximize"></span>
                                    </div>
                                    <span class="ide-titlebar-title">Changelog Stream</span>
                                </div>
                                <div id="changelog" class="changelog" style="padding: 15px; max-height: 280px; overflow-y: auto; background: var(--bg-code);">
                                    <div style="text-align: center; color: var(--ui-muted-text);">Waiting...</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="legend" style="margin-top: 20px;">
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--legend-insert);"></div>
                            <span>+I Insert</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--legend-update-before);"></div>
                            <span>-U Retract</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--legend-update-after);"></div>
                            <span>+U Update</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: var(--legend-delete);"></div>
                            <span>-D Delete</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 3: Stream Types -->
            <div class="demo-section" id="section-3">
                <h2 class="section-title">Changelog Modes</h2>
                <div class="description">
                    Flink SQL automatically determines the changelog mode based on your query semantics.
                </div>

                <div class="visualization">
                    <div style="display: grid; gap: 20px;">
                        <!-- Insert-Only -->
                        <div class="ide-window" style="margin: 0;">
                            <div class="ide-titlebar">
                                <div class="ide-titlebar-buttons">
                                    <span class="ide-titlebar-btn close"></span>
                                    <span class="ide-titlebar-btn minimize"></span>
                                    <span class="ide-titlebar-btn maximize"></span>
                                </div>
                                <span class="ide-titlebar-title">Insert-Only (Append)</span>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0;">
                                <div class="ide-editor" style="border-right: 1px solid var(--bg-code-border);">
                                    <div class="ide-line-numbers">
                                        <div class="ide-line-number">1</div>
                                        <div class="ide-line-number">2</div>
                                    </div>
                                    <div class="ide-code-content">
                                        <div class="ide-code-line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> orders</div>
                                        <div class="ide-code-line"><span class="keyword">WHERE</span> amount > 100;</div>
                                    </div>
                                </div>
                                <div style="padding: 16px; background: var(--bg-code); color: var(--code-text); font-family: 'JetBrains Mono', monospace; font-size: 0.85em;">
                                    <div style="color: var(--legend-insert);">+I[Alice, 150]</div>
                                    <div style="color: var(--legend-insert);">+I[Bob, 200]</div>
                                    <div style="color: var(--legend-insert);">+I[Alice, 300]</div>
                                </div>
                            </div>
                            <div style="padding: 12px 16px; background: var(--stream-insert-bg); border-top: 1px solid var(--stream-insert-border); font-size: 0.85em; color: var(--stream-insert-heading);">
                                <strong>Use Case:</strong> Filters, projections, simple transforms
                            </div>
                        </div>

                        <!-- Retract -->
                        <div class="ide-window" style="margin: 0;">
                            <div class="ide-titlebar">
                                <div class="ide-titlebar-buttons">
                                    <span class="ide-titlebar-btn close"></span>
                                    <span class="ide-titlebar-btn minimize"></span>
                                    <span class="ide-titlebar-btn maximize"></span>
                                </div>
                                <span class="ide-titlebar-title">Retract Stream</span>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0;">
                                <div class="ide-editor" style="border-right: 1px solid var(--bg-code-border);">
                                    <div class="ide-line-numbers">
                                        <div class="ide-line-number">1</div>
                                        <div class="ide-line-number">2</div>
                                        <div class="ide-line-number">3</div>
                                    </div>
                                    <div class="ide-code-content">
                                        <div class="ide-code-line"><span class="keyword">SELECT</span> user_id, <span class="function">SUM</span>(amount)</div>
                                        <div class="ide-code-line"><span class="keyword">FROM</span> orders</div>
                                        <div class="ide-code-line"><span class="keyword">GROUP BY</span> user_id;</div>
                                    </div>
                                </div>
                                <div style="padding: 16px; background: var(--bg-code); color: var(--code-text); font-family: 'JetBrains Mono', monospace; font-size: 0.85em;">
                                    <div style="color: var(--legend-insert);">+I[Alice, 100]</div>
                                    <div style="color: var(--legend-update-before);">-U[Alice, 100]</div>
                                    <div style="color: var(--legend-update-after);">+U[Alice, 300]</div>
                                </div>
                            </div>
                            <div style="padding: 12px 16px; background: var(--stream-retract-bg); border-top: 1px solid var(--stream-retract-border); font-size: 0.85em; color: var(--stream-retract-heading);">
                                <strong>Use Case:</strong> Aggregations (SUM, COUNT, AVG)
                            </div>
                        </div>

                        <!-- Upsert -->
                        <div class="ide-window" style="margin: 0;">
                            <div class="ide-titlebar">
                                <div class="ide-titlebar-buttons">
                                    <span class="ide-titlebar-btn close"></span>
                                    <span class="ide-titlebar-btn minimize"></span>
                                    <span class="ide-titlebar-btn maximize"></span>
                                </div>
                                <span class="ide-titlebar-title">Upsert Stream (with Primary Key)</span>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0;">
                                <div class="ide-editor" style="border-right: 1px solid var(--bg-code-border);">
                                    <div class="ide-line-numbers">
                                        <div class="ide-line-number">1</div>
                                        <div class="ide-line-number">2</div>
                                        <div class="ide-line-number">3</div>
                                        <div class="ide-line-number">4</div>
                                    </div>
                                    <div class="ide-code-content">
                                        <div class="ide-code-line"><span class="keyword">INSERT INTO</span> user_totals</div>
                                        <div class="ide-code-line"><span class="keyword">SELECT</span> user_id, <span class="function">SUM</span>(amount)</div>
                                        <div class="ide-code-line"><span class="keyword">FROM</span> orders</div>
                                        <div class="ide-code-line"><span class="keyword">GROUP BY</span> user_id;</div>
                                    </div>
                                </div>
                                <div style="padding: 16px; background: var(--bg-code); color: var(--code-text); font-family: 'JetBrains Mono', monospace; font-size: 0.85em;">
                                    <div style="color: var(--legend-insert);">+I[Alice, 100]</div>
                                    <div style="color: var(--legend-update-after);">+U[Alice, 300]</div>
                                    <div style="color: #f85149;">-D[Bob, 50]</div>
                                </div>
                            </div>
                            <div style="padding: 12px 16px; background: var(--stream-upsert-bg); border-top: 1px solid var(--stream-upsert-border); font-size: 0.85em; color: var(--stream-upsert-heading);">
                                <strong>Use Case:</strong> Sink with primary key, CDC, upsert-kafka connector
                            </div>
                        </div>
                    </div>

                    <div class="info-box" style="margin-top: 25px;">
                        <strong>Automatic Mode Selection:</strong> Flink determines the changelog mode from your query. 
                        Sinks with primary keys enable upsert mode; otherwise retract mode is used for aggregations.
                    </div>
                </div>
            </div>

            <!-- Section 4: Live Aggregation -->
            <div class="demo-section" id="section-4">
                <h2 class="section-title">Live SQL Aggregation</h2>
                <div class="description">
                    Watch real-time SQL aggregation with continuous changelog output
                </div>

                <div class="controls">
                    <button class="btn btn-primary" onclick="startAggregation()">‚ñ∂ Start</button>
                    <button class="btn btn-secondary" onclick="stopAggregation()">‚è∏ Pause</button>
                    <button class="btn btn-secondary" onclick="resetAggregation()">Reset</button>
                </div>

                <div class="visualization">
                    <!-- SQL Query Window -->
                    <div class="ide-window">
                        <div class="ide-titlebar">
                            <div class="ide-titlebar-buttons">
                                <span class="ide-titlebar-btn close"></span>
                                <span class="ide-titlebar-btn minimize"></span>
                                <span class="ide-titlebar-btn maximize"></span>
                            </div>
                            <span class="ide-titlebar-title">live_aggregation.sql</span>
                        </div>
                        <div class="ide-editor">
                            <div class="ide-line-numbers">
                                <div class="ide-line-number">1</div>
                                <div class="ide-line-number highlighted">2</div>
                                <div class="ide-line-number highlighted">3</div>
                                <div class="ide-line-number highlighted">4</div>
                                <div class="ide-line-number highlighted">5</div>
                            </div>
                            <div class="ide-code-content">
                                <div class="ide-code-line"><span class="comment">-- Continuous aggregation query</span></div>
                                <div class="ide-code-line highlighted"><span class="keyword">SELECT</span> user_id,</div>
                                <div class="ide-code-line highlighted">       <span class="function">SUM</span>(amount) <span class="keyword">AS</span> total,</div>
                                <div class="ide-code-line highlighted">       <span class="function">COUNT</span>(*) <span class="keyword">AS</span> order_count</div>
                                <div class="ide-code-line highlighted"><span class="keyword">FROM</span> orders <span class="keyword">GROUP BY</span> user_id;</div>
                            </div>
                        </div>
                    </div>

                    <div class="split-view" style="margin-top: 20px;">
                        <div>
                            <div class="ide-window" style="margin: 0;">
                                <div class="ide-titlebar">
                                    <div class="ide-titlebar-buttons">
                                        <span class="ide-titlebar-btn close"></span>
                                        <span class="ide-titlebar-btn minimize"></span>
                                        <span class="ide-titlebar-btn maximize"></span>
                                    </div>
                                    <span class="ide-titlebar-title">Kafka: orders topic</span>
                                </div>
                                <div id="agg-input" style="background: var(--bg-code); padding: 15px; min-height: 220px; max-height: 220px; overflow-y: auto; font-family: 'JetBrains Mono', monospace; font-size: 0.8em; color: var(--code-text);">
                                    <div style="text-align: center; color: var(--ui-muted-text); padding: 40px 0;">Waiting for events...</div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <div class="ide-window" style="margin: 0;">
                                <div class="ide-titlebar">
                                    <div class="ide-titlebar-buttons">
                                        <span class="ide-titlebar-btn close"></span>
                                        <span class="ide-titlebar-btn minimize"></span>
                                        <span class="ide-titlebar-btn maximize"></span>
                                    </div>
                                    <span class="ide-titlebar-title">Query Result (Updating)</span>
                                </div>
                                <div class="table-container" style="border: none; border-radius: 0;">
                                    <table id="agg-result-table">
                                        <thead>
                                            <tr>
                                                <th>user_id</th>
                                                <th>total</th>
                                                <th>order_count</th>
                                            </tr>
                                        </thead>
                                        <tbody id="agg-result-body">
                                            <tr><td colspan="3" style="text-align: center; color: var(--ui-muted-text);">No data</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Changelog Output -->
                    <div class="ide-window" style="margin-top: 20px;">
                        <div class="ide-titlebar">
                            <div class="ide-titlebar-buttons">
                                <span class="ide-titlebar-btn close"></span>
                                <span class="ide-titlebar-btn minimize"></span>
                                <span class="ide-titlebar-btn maximize"></span>
                            </div>
                            <span class="ide-titlebar-title">Changelog Stream Output</span>
                        </div>
                        <div id="agg-changelog" class="changelog" style="background: var(--bg-code); padding: 15px; max-height: 180px; overflow-y: auto;">
                            <div style="text-align: center; color: var(--ui-muted-text);">Changelog output...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 5: Code Examples -->
            <div class="demo-section" id="section-5">
                <h2 class="section-title">SQL &amp; Table API Examples</h2>
                <div class="description">
                    Complete examples using Flink SQL and the fluent Table API
                </div>

                <div class="controls">
                    <button class="btn btn-primary" onclick="runTerminalDemo()">‚ñ∂ Run Demo</button>
                    <button class="btn btn-secondary" onclick="resetTerminalDemo()">Reset</button>
                </div>

                <div class="visualization">
                    <!-- IDE Layout with File Tree -->
                    <div class="ide-layout">
                        <!-- File Tree Sidebar -->
                        <div class="file-tree">
                            <div class="file-tree-header">
                                <span>Explorer</span>
                            </div>
                            <div class="file-tree-content">
                                <div class="file-tree-item folder">
                                    <span class="file-tree-icon folder">üìÅ</span>
                                    <span class="file-tree-name">flink-sql-demo</span>
                                </div>
                                <div class="file-tree-item folder" style="padding-left: 28px;">
                                    <span class="file-tree-icon folder">üìÅ</span>
                                    <span class="file-tree-name">sql</span>
                                </div>
                                <div class="file-tree-item active" style="padding-left: 42px;" onclick="showCodeTab('ddl')">
                                    <span class="file-tree-icon sql">üìÑ</span>
                                    <span class="file-tree-name">create_tables.sql</span>
                                </div>
                                <div class="file-tree-item" style="padding-left: 42px;" onclick="showCodeTab('aggregation')">
                                    <span class="file-tree-icon sql">üìÑ</span>
                                    <span class="file-tree-name">aggregation.sql</span>
                                </div>
                                <div class="file-tree-item" style="padding-left: 42px;" onclick="showCodeTab('window')">
                                    <span class="file-tree-icon sql">üìÑ</span>
                                    <span class="file-tree-name">window_agg.sql</span>
                                </div>
                                <div class="file-tree-item folder" style="padding-left: 28px;">
                                    <span class="file-tree-icon folder">üìÅ</span>
                                    <span class="file-tree-name">src/main/java</span>
                                </div>
                                <div class="file-tree-item" style="padding-left: 42px;" onclick="showCodeTab('table-api')">
                                    <span class="file-tree-icon java">‚òï</span>
                                    <span class="file-tree-name">TableApiDemo.java</span>
                                </div>
                                <div class="file-tree-item" style="padding-left: 14px;">
                                    <span class="file-tree-icon xml">üìÑ</span>
                                    <span class="file-tree-name">pom.xml</span>
                                </div>
                            </div>
                        </div>

                        <!-- Main IDE Area -->
                        <div class="ide-main">
                            <!-- IDE Tabs -->
                            <div class="ide-tabs">
                                <button class="ide-tab active" onclick="showCodeTab('ddl')">
                                    <span class="ide-tab-icon sql">üìÑ</span>
                                    create_tables.sql
                                </button>
                                <button class="ide-tab" onclick="showCodeTab('aggregation')">
                                    <span class="ide-tab-icon sql">üìÑ</span>
                                    aggregation.sql
                                </button>
                                <button class="ide-tab" onclick="showCodeTab('window')">
                                    <span class="ide-tab-icon sql">üìÑ</span>
                                    window_agg.sql
                                </button>
                                <button class="ide-tab" onclick="showCodeTab('table-api')">
                                    <span class="ide-tab-icon java">‚òï</span>
                                    TableApiDemo.java
                                </button>
                            </div>

                            <!-- Code Editor Panels -->
                            <div id="code-panel-ddl" class="ide-editor">
                                <div class="ide-line-numbers">
                                    <div class="ide-line-number">1</div>
                                    <div class="ide-line-number">2</div>
                                    <div class="ide-line-number">3</div>
                                    <div class="ide-line-number">4</div>
                                    <div class="ide-line-number">5</div>
                                    <div class="ide-line-number">6</div>
                                    <div class="ide-line-number">7</div>
                                    <div class="ide-line-number">8</div>
                                    <div class="ide-line-number">9</div>
                                    <div class="ide-line-number">10</div>
                                    <div class="ide-line-number">11</div>
                                    <div class="ide-line-number">12</div>
                                    <div class="ide-line-number">13</div>
                                    <div class="ide-line-number">14</div>
                                </div>
                                <div class="ide-code-content">
                                    <div class="ide-code-line"><span class="comment">-- Source table from Kafka</span></div>
                                    <div class="ide-code-line"><span class="keyword">CREATE TABLE</span> orders (</div>
                                    <div class="ide-code-line">    order_id    <span class="function">STRING</span>,</div>
                                    <div class="ide-code-line">    user_id     <span class="function">STRING</span>,</div>
                                    <div class="ide-code-line">    amount      <span class="function">DECIMAL</span>(10, 2),</div>
                                    <div class="ide-code-line">    order_time  <span class="function">TIMESTAMP</span>(3),</div>
                                    <div class="ide-code-line">    <span class="keyword">WATERMARK FOR</span> order_time <span class="keyword">AS</span> order_time - <span class="function">INTERVAL</span> <span class="string">'5'</span> <span class="function">SECOND</span></div>
                                    <div class="ide-code-line">) <span class="keyword">WITH</span> (</div>
                                    <div class="ide-code-line">    <span class="string">'connector'</span> = <span class="string">'kafka'</span>,</div>
                                    <div class="ide-code-line">    <span class="string">'topic'</span> = <span class="string">'orders'</span>,</div>
                                    <div class="ide-code-line">    <span class="string">'properties.bootstrap.servers'</span> = <span class="string">'localhost:9092'</span>,</div>
                                    <div class="ide-code-line">    <span class="string">'format'</span> = <span class="string">'json'</span>,</div>
                                    <div class="ide-code-line">    <span class="string">'scan.startup.mode'</span> = <span class="string">'earliest-offset'</span></div>
                                    <div class="ide-code-line">);</div>
                                </div>
                            </div>

                            <div id="code-panel-aggregation" class="ide-editor" style="display: none;">
                                <div class="ide-line-numbers">
                                    <div class="ide-line-number">1</div>
                                    <div class="ide-line-number">2</div>
                                    <div class="ide-line-number highlighted">3</div>
                                    <div class="ide-line-number highlighted">4</div>
                                    <div class="ide-line-number highlighted">5</div>
                                    <div class="ide-line-number highlighted">6</div>
                                    <div class="ide-line-number">7</div>
                                    <div class="ide-line-number">8</div>
                                    <div class="ide-line-number">9</div>
                                    <div class="ide-line-number">10</div>
                                    <div class="ide-line-number">11</div>
                                </div>
                                <div class="ide-code-content">
                                    <div class="ide-code-line"><span class="comment">-- Continuous aggregation with changelog output</span></div>
                                    <div class="ide-code-line"><span class="comment">-- Produces: +I (insert), -U/+U (update), -D (delete)</span></div>
                                    <div class="ide-code-line highlighted"><span class="keyword">SELECT</span></div>
                                    <div class="ide-code-line highlighted">    user_id,</div>
                                    <div class="ide-code-line highlighted">    <span class="function">SUM</span>(amount) <span class="keyword">AS</span> total_amount,</div>
                                    <div class="ide-code-line highlighted">    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> order_count</div>
                                    <div class="ide-code-line"><span class="keyword">FROM</span> orders</div>
                                    <div class="ide-code-line"><span class="keyword">GROUP BY</span> user_id;</div>
                                    <div class="ide-code-line"></div>
                                    <div class="ide-code-line"><span class="comment">-- Output: +I[Alice, 100, 1] ‚Üí -U[Alice, 100, 1] ‚Üí +U[Alice, 250, 2]</span></div>
                                    <div class="ide-code-line"><span class="comment">-- Each new order updates the running total</span></div>
                                </div>
                            </div>

                            <div id="code-panel-window" class="ide-editor" style="display: none;">
                                <div class="ide-line-numbers">
                                    <div class="ide-line-number">1</div>
                                    <div class="ide-line-number">2</div>
                                    <div class="ide-line-number highlighted">3</div>
                                    <div class="ide-line-number highlighted">4</div>
                                    <div class="ide-line-number highlighted">5</div>
                                    <div class="ide-line-number highlighted">6</div>
                                    <div class="ide-line-number highlighted">7</div>
                                    <div class="ide-line-number">8</div>
                                    <div class="ide-line-number">9</div>
                                </div>
                                <div class="ide-code-content">
                                    <div class="ide-code-line"><span class="comment">-- Tumbling window aggregation (10-minute windows)</span></div>
                                    <div class="ide-code-line"><span class="comment">-- Window results are append-only (+I only)</span></div>
                                    <div class="ide-code-line highlighted"><span class="keyword">SELECT</span></div>
                                    <div class="ide-code-line highlighted">    window_start, window_end,</div>
                                    <div class="ide-code-line highlighted">    user_id,</div>
                                    <div class="ide-code-line highlighted">    <span class="function">SUM</span>(amount) <span class="keyword">AS</span> window_total</div>
                                    <div class="ide-code-line highlighted"><span class="keyword">FROM TABLE</span>(<span class="function">TUMBLE</span>(<span class="keyword">TABLE</span> orders, <span class="function">DESCRIPTOR</span>(order_time), <span class="function">INTERVAL</span> <span class="string">'10'</span> <span class="function">MINUTES</span>))</div>
                                    <div class="ide-code-line"><span class="keyword">GROUP BY</span> window_start, window_end, user_id;</div>
                                    <div class="ide-code-line"></div>
                                </div>
                            </div>

                            <div id="code-panel-table-api" class="ide-editor" style="display: none;">
                                <div class="ide-line-numbers">
                                    <div class="ide-line-number">1</div>
                                    <div class="ide-line-number">2</div>
                                    <div class="ide-line-number">3</div>
                                    <div class="ide-line-number">4</div>
                                    <div class="ide-line-number">5</div>
                                    <div class="ide-line-number">6</div>
                                    <div class="ide-line-number">7</div>
                                    <div class="ide-line-number highlighted">8</div>
                                    <div class="ide-line-number highlighted">9</div>
                                    <div class="ide-line-number highlighted">10</div>
                                    <div class="ide-line-number highlighted">11</div>
                                    <div class="ide-line-number highlighted">12</div>
                                    <div class="ide-line-number">13</div>
                                    <div class="ide-line-number">14</div>
                                </div>
                                <div class="ide-code-content">
                                    <div class="ide-code-line"><span class="keyword">import static</span> org.apache.flink.table.api.Expressions.$;</div>
                                    <div class="ide-code-line"><span class="keyword">import static</span> org.apache.flink.table.api.Expressions.lit;</div>
                                    <div class="ide-code-line"></div>
                                    <div class="ide-code-line">TableEnvironment tableEnv = TableEnvironment.<span class="function">create</span>(</div>
                                    <div class="ide-code-line">    EnvironmentSettings.<span class="function">inStreamingMode</span>());</div>
                                    <div class="ide-code-line"></div>
                                    <div class="ide-code-line"><span class="comment">// Fluent Table API - same semantics as SQL</span></div>
                                    <div class="ide-code-line highlighted">Table result = tableEnv.<span class="function">from</span>(<span class="string">"orders"</span>)</div>
                                    <div class="ide-code-line highlighted">    .<span class="function">groupBy</span>($(<span class="string">"user_id"</span>))</div>
                                    <div class="ide-code-line highlighted">    .<span class="function">select</span>(</div>
                                    <div class="ide-code-line highlighted">        $(<span class="string">"user_id"</span>),</div>
                                    <div class="ide-code-line highlighted">        $(<span class="string">"amount"</span>).<span class="function">sum</span>().<span class="function">as</span>(<span class="string">"total"</span>),</div>
                                    <div class="ide-code-line">        lit(1).<span class="function">count</span>().<span class="function">as</span>(<span class="string">"cnt"</span>));</div>
                                    <div class="ide-code-line">result.<span class="function">execute</span>().<span class="function">print</span>();</div>
                                </div>
                            </div>

                            <!-- Status Bar -->
                            <div class="ide-statusbar">
                                <div class="ide-statusbar-left">
                                    <span class="ide-statusbar-item">SQL</span>
                                    <span class="ide-statusbar-item">UTF-8</span>
                                </div>
                                <div class="ide-statusbar-right">
                                    <span class="ide-statusbar-item">Flink 1.20</span>
                                    <span class="ide-statusbar-item">Ln 3, Col 1</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Terminal Window -->
                    <div class="terminal-window">
                        <div class="terminal-header">
                            <div class="terminal-header-buttons">
                                <span class="terminal-header-btn close"></span>
                                <span class="terminal-header-btn minimize"></span>
                                <span class="terminal-header-btn maximize"></span>
                            </div>
                            <span class="terminal-header-title">Flink SQL Client</span>
                        </div>
                        <div class="terminal-body" id="terminal-output">
                            <div class="terminal-line">
                                <span class="terminal-prompt">Flink SQL&gt;</span>
                                <span class="terminal-command"> SELECT user_id, SUM(amount) FROM orders GROUP BY user_id;</span>
                            </div>
                            <div class="terminal-line terminal-info">[INFO] Submitting SQL query...</div>
                            <div class="terminal-line terminal-success">[INFO] Query submitted successfully</div>
                            <div class="terminal-line">
                                <span class="terminal-prompt">Flink SQL&gt;</span>
                                <span class="terminal-cursor"></span>
                            </div>
                        </div>
                    </div>

                    <div class="info-box" style="margin-top: 20px;">
                        <strong>SQL vs Table API:</strong> Both produce identical execution plans and changelog semantics.
                        Use SQL for ad-hoc queries and Table API for programmatic pipelines in Java/Scala/Python.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</html>